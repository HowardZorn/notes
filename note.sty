% math
\defaultfontfeatures{Mapping=tex-text} % to support TeX conventions like ``---''
\usepackage{amsmath, amssymb, amsfonts}
\usepackage{bm} % bold math
\usepackage{xspace}
\usepackage{extarrows}
\usepackage{multirow}  % tabular
\usepackage{nicefrac}  % 分数更好看
\usepackage{xunicode} % Unicode support for LaTeX character names (accents, European chars, etc)
\usepackage{booktabs} % professional-quality tables
\usepackage{xltxtra} % Extra customizations for XeLaTeX\usepackage{geometry} % See geometry.pdf to learn the layout options. There are lots.
\usepackage[margin={1in,1.25in}]{geometry} % See geometry.pdf to learn the layout options. There are lots.
\geometry{a4paper} % or letterpaper (US) or a5paper or....
%\usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx} % to support the \includegraphics command and options
\usepackage{hyperref} % to support the \href command
\usepackage{minted} % to support the code showing
\usepackage{enumitem} % enumerate
\usepackage{capt-of} % to support the \captionof command
% support caption commands
\usepackage{caption}
\usepackage{subcaption}
% bibliography
\usepackage[numbers,super,square]{natbib}
\bibliographystyle{unsrtnat}

% ploting
\usepackage{tikz}

% 中文句号改为句点
\catcode`\。=\active
\newcommand{。}{\ifmmode\text{．}\else ．\fi}
% 中文强调用着重号，总之不用楷体……
\usepackage{xeCJKfntef}
\renewcommand{\emph}[1]{\CJKunderdot[textformat=\itshape]{#1}}
% 节标题左对齐
\ctexset{
  section/format += \raggedright
}
% pdf title & author
\makeatletter
\AtBeginDocument{
  \hypersetup{
    pdftitle = {\@title},
    pdfauthor = {\@author}
  }
}
\makeatother
% algorithm
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage[spaceRequire=false]{algpseudocodex}
\floatname{algorithm}{算法}
\renewcommand{\algorithmicrequire}{\textbf{输入：}}
\renewcommand{\algorithmicensure}{\textbf{输出：}}

% Werner, https://link.zhihu.com/?target=https%3A//tex.stackexchange.com/questions/33866/algorithm-tag-and-page-break
\makeatletter
\newenvironment{breakablealgorithm}
  {% \begin{breakablealgorithm}
    \begin{center}
      \refstepcounter{algorithm}% New algorithm
      \hrule height.8pt depth0pt \kern2pt% \@fs@pre for \@fs@ruled
      \parskip 0pt
      \renewcommand{\caption}[2][\relax]{% Make a new \caption
        {\raggedright\textbf{\fname@algorithm~\thealgorithm} ##2\par}%
        \ifx\relax##1\relax % #1 is \relax
          \addcontentsline{loa}{algorithm}{\protect\numberline{\thealgorithm}##2}%
        \else % #1 is not \relax
          \addcontentsline{loa}{algorithm}{\protect\numberline{\thealgorithm}##1}%
        \fi
        \kern2pt\hrule\kern2pt
     }
  }
  {% \end{breakablealgorithm}
     \kern2pt\hrule\relax% \@fs@post for \@fs@ruled
   \end{center}
  }
\makeatother

% definition
\newtheorem{definition}{定义}
% headers
\usepackage{fancyhdr}

% fonts, xelatex
\usepackage{xeCJK}
\xeCJKDeclareCharClass{CJK}{%
  "24EA,        % ⓪
  "2460->"2473, % ①–⑳
  "3251->"32BF, % ㉑–㊿
  "24FF,        % ⓿
  "2776->"277F, % ❶–❿
  "24EB->"24F4  % ⓫–⓴
}
% \setmainfont {Source Serif Pro}
% \setsansfont {Source Sans Pro}
% \setmonofont {Source Code Pro}
\setCJKmainfont {Source Han Serif SC} [ItalicFont = FandolFang]
\setCJKsansfont {Source Han Sans SC} [ItalicFont = FandolKai]
\setCJKmonofont {Source Han Serif SC}
\setCJKfamilyfont {zhsong} {Source Han Serif SC}
\setCJKfamilyfont {zhhei} {Source Han Sans SC}
\setCJKfamilyfont {zhfs} {FandolFang}
\setCJKfamilyfont {zhkai} {FandolKai}
